rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ğŸ“ ãƒ¡ãƒ¢æ©Ÿèƒ½
    match /memos/{memoId} {
      // èª­ã‚€: IDãŒè‡ªåˆ†ã®UIDã§å§‹ã¾ã‚‹ã€ã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ãŒè‡ªåˆ†ã®ã‚‚ã®
      // (resource == null ã¯ã€Œãƒ‡ãƒ¼ã‚¿ãŒç„¡ã„ã€çŠ¶æ…‹ã®å–å¾—ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«å¿…è¦)
      allow get: if request.auth != null && (
        resource == null || resource.data.userId == request.auth.uid
      );
      
      // ä¸€è¦§: è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿
      allow list: if request.auth != null && resource.data.userId == request.auth.uid;
      
      // æ›¸ãè¾¼ã¿: UIDãŒä¸€è‡´ã™ã‚‹ã“ã¨
      allow write: if request.auth != null && request.resource.data.userId == request.auth.uid;
    }
    
    // ğŸ” ãã®ä»–ï¼ˆæ¤œç´¢çµæœãªã©ï¼‰ã¯APIçµŒç”±ãªã®ã§APIä»¥å¤–ã‚¢ã‚¯ã‚»ã‚¹ç¦æ­¢
    match /{document=**} {
      allow read, write: if false;
    }
  }
}